F=: 'm'fread'~temp/euler.txt'
S=: _10("."0)@:}.\F
int=: [-.-.
cr=: 1-~:"1
pencil=: 3 : 0
 r=. (i.10) <@:-."1    y
 c=. (i.10) <@:-."1 |: y
 z=. 3#"1]3#(3 3,:3 3)((i.10)<@:-.,);._3 y
 y ]`[@.(0<[)&.> z int&.> r int&.>/ c
)
zi=: ,/27&+^:(<3)3&+^:(<3),9&+^:(<3)0 1 2
rc=: ,|:i.9 9
sudoku=: 3 : 0
 g=. pencil y
 t=. #S:0 g
 i=. 9 9$0
 while. 1 do.
  b=. i{&>g
  j=. i.&1@:,@:(cr+.cr&.|:+.zi&(9 9$[/:~&,(cr@:{,)))b
  if. j>:81 do. b return. end.
  i=. 9 9$(t&|+1|.<.@:%&t)^:_ j(1+{)`[`]},i
 end.
)