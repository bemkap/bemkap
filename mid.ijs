i=: 1 : 'u@>@{. ,^:(0 -.@e. $@[) }.'

nop  =: <@]
match=: nop`([ ;~ -&# {. ])@.({.@E.)
one  =: }. ; {.
cond =: (@{.)(nop`one@.)
many =: ^:_