d=: (10 <.@:>:@^. ])`0:@.(0&=)"0
ext=: [:,(+(>:i.9)*/10^d)"0
next=: 4 : 'x(]#~(2>:10|(<.@%)&(10^<:d{.y))@:*)y'
f=: 3 : 0
 p=. <:i=. 1
 while. 1 do.
  p=. /:~y(next ext)p
  if. (#p)>j=. 1 i.~ 10(2*./"1@:>:#.inv)(10^i)<.@:%~y*p do. break. end.
  i=. >:i
 end.j{p
)