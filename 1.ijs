N=: '[[[[4,3],4],4],[7,[[8,4],9]]]'
M=: '[1,1]'

depth=: _1+'[],'(3&=#1 _1 0 0+/\@:{~])@:i.]
num=: ".@:(#~'[]'&(-.@:e.~))
to=: num,:depth
sum=: 4 : 0
 a=. 0 1 +"0 1 x ,.&to y
 b=. (,{;~_ 0 1)i.2<\_,_,~4={:a
 c=. 2<\_,_,~{.a
 NB. r=. 0$0
 NB. for_i. i.#b do. r=. r,<_:`{:`0:`{.`]`(+/)`0:`(+/)`(0$0"_)@.(i{b)i{::c end.
)