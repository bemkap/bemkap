I=: '.|#' i. 'm' fread '~temp/input18.txt'

o=: 4&{ + 3 <: 1 +/ .= ]
t=: 4&{ + 3 <: 2 +/ .= ]
l=: 2 * (1 <: 1 +/ .= ]) *. 2 <: 2 +/ .= ]

e=: 0,.0,.~0,0,~]
f=: [: o`t`l@.(4&{) ,
n=: (1 1,:3 3) f;._3 e

cnt=: ([: (2&(+/ .=) * 1&(+/ .=)) ,)"2
s1=: cnt n^:10 I
s2=: cnt n^:(407+28|1000000000-407) I